---
title: "Feeling Connected"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T)
```

```{r echo=F}
library(tidyverse)
library(ggthemes)
library(sf)  # need to import sf in order for readRDS to work correctly
library(plotly)
```

```{r}
# Load data
t <- "20201227_235052"
data.connectedness <- read.csv(paste("data/connectedness_", t, ".csv", sep=""))
# "Jitter" values just a little bit, so it's easier to see overlapping points
c_jitter <- data.connectedness %>%
    mutate(Day=jitter(Day, factor=1)) %>%  # x
    mutate(Connectedness=jitter(Connectedness, factor=.5)) %>%  # y
    mutate(Housing.F20=factor(Housing.F20, levels=c("On-campus Stiles", "On-campus OC", "Off-campus", "Remote")))
```

## Connectedness by graduation year

```{r}
g <- ggplot(c_jitter, aes(x=Day, y=Connectedness, color=factor(Year), group=ID)) +
    geom_line(alpha=0.15) +
    geom_point(alpha=0.35) +
    scale_y_continuous(breaks=1:10) +
    scale_x_continuous(breaks=unique(data.connectedness$Day)) +
    scale_color_brewer(palette="Spectral") +
    theme_tufte()
ggplotly(g)

# https://stackoverflow.com/questions/36227482/r-ggplot-dodging-geom-lines
# https://ggplot2.tidyverse.org/reference/scale_brewer.html
```

Note that you can selectively view graduation years, or groups of graduation years, by clicking on the legend above.

Guiding question: what is the trend in connectedness over time?

## Connectedness by proximity to campus in Fall 2020

```{r}
g <- ggplot(c_jitter %>% filter(!is.na(Housing.F20)),
            aes(x=Day, y=Connectedness, color=Housing.F20, group=ID)) +
    geom_line(alpha=0.15) +
    geom_point(alpha=0.35) +
    scale_y_continuous(breaks=1:10) +
    scale_x_continuous(breaks=unique(data.connectedness$Day)) +
    scale_color_brewer(palette="Spectral") +
    theme_tufte()
ggplotly(g)
```

Focus on the Fall semester: what's going on in Day 327?

## Connectedness by enrollment status in Fall 2020
```{r}
g <- ggplot(c_jitter, aes(x=Day, y=Connectedness, color=Enrolled.F20, shape=Enrolled.F20, group=ID)) +
    geom_line(alpha=0.25) +
    geom_point(alpha=0.45) +
    scale_y_continuous(breaks=1:10) +
    scale_x_continuous(breaks=unique(data.connectedness$Day)) +
    scale_color_brewer(palette="Pastel1") +
    theme_tufte()
ggplotly(g)
```

Once again: helpful to look specifically at Fall 2020.

## Small multiples

```{r}
g <- ggplot(c_jitter %>% filter(!is.na(Housing.F20)),
            aes(x=Day, y=Connectedness, color=as.factor(Year), group=ID)) +
    geom_line(alpha=0.5) +
    geom_point(alpha=0.6) +
    scale_y_continuous(breaks=1:10) +
    scale_x_continuous(breaks=unique(data.connectedness$Day)) +
    scale_color_colorblind() +
    facet_grid(Housing.F20 ~ Enrolled.F20) +
    theme_tufte()
ggplotly(g)
```


## Guiding Questions

* For each year/grade: which time represents the highest connectedness?
* How does connectedness vary between location and enrollment in F20?
* What happens to connectedness over Spring break and Summer?

Also note that the remainder of the year, from November 21 through December, is just assumed to be constant.